<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Route Requests</title>
<style>
body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
header { background: #222; color: white; padding: 10px; display: flex; justify-content: space-between; align-items: center; }
.hamburger { font-size: 24px; cursor: pointer; }
nav a { color: white; margin: 0 10px; text-decoration: none; }
nav.open { display: block; }
nav { display: flex; }
main { padding: 20px; }
form { display: flex; flex-direction: column; max-width: 400px; }
input, select { margin: 5px 0; padding: 8px; font-size: 16px; }
button { margin-top: 10px; padding: 10px; font-size: 16px; cursor: pointer; }
table { margin-top: 20px; border-collapse: collapse; width: 100%; }
th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
#status { margin-top: 10px; font-weight: bold; }
footer { text-align: center; padding: 10px; background: #eee; margin-top: 20px; }
</style>
</head>
<body>

<header>
<div class="hamburger" onclick="toggleMenu()">‚ò∞</div>
<nav id="menu">
<a href="index.html">üè† Home</a>
<a href="routes.html">üìã Route Requests</a>
<a href="quota.html">üßæ Quota Logger</a>
</nav>
</header>

<main>
<h2>üìã Route Requests</h2>

<form id="routeForm">
<input type="text" id="username" placeholder="Roblox Username" required>
<input type="text" id="route" placeholder="Route Name" required>
<input type="date" id="date" required>
<!-- Open-ended Time -->
<input type="text" id="time" placeholder="Time (e.g., 07:45 AM)" required>
<button type="submit">Submit Request</button>
</form>

<h3>Pending Requests</h3>
<table id="pendingRequests">
<tr>
<th>User</th>
<th>Route</th>
<th>Date</th>
<th>Time</th>
<th>Actions</th>
</tr>
</table>

<p id="status"></p>
</main>

<footer>
Made by Elian ‚Äî Route Executive Director
</footer>

<script>
// Toggle hamburger menu
function toggleMenu() {
const menu = document.getElementById('menu');
menu.classList.toggle('open');
}

// Submit Route Request to Google Sheet
document.getElementById("routeForm").addEventListener("submit", async function(e) {
e.preventDefault();

const username = document.getElementById("username").value;
const route = document.getElementById("route").value;
const date = document.getElementById("date").value;
const time = document.getElementById("time").value;

try {
const response = await fetch("https://script.google.com/macros/s/AKfycbwql6_UkOlV7heM5UnNoyyb5JkscizXD5CpBhQ8uCUxkIRrp8ER2ktxDiWbP0cXBgCQlw/exec", { // <-- Replace with your Google Apps Script Web App URL
method: "POST",
body: JSON.stringify({ username, route, date, time }),
headers: { "Content-Type": "application/json" }
});

const result = await response.json();

if(result.result === "success") {
document.getElementById("status").innerText = "‚úÖ Route request submitted successfully!";
document.getElementById("routeForm").reset();

// Add to pending requests table
const table = document.getElementById("pendingRequests");
const newRow = table.insertRow();
newRow.insertCell(0).innerText = username;
newRow.insertCell(1).innerText = route;
newRow.insertCell(2).innerText = date;
newRow.insertCell(3).innerText = time;
const actionsCell = newRow.insertCell(4);
actionsCell.innerHTML = "<button onclick='removeRow(this)'>‚ùå Remove</button>";

} else {
document.getElementById("status").innerText = "‚ùå Submission failed. Try again.";
}

} catch (error) {
console.error(error);
document.getElementById("status").innerText = "‚ùå Error submitting request.";
}
});

// Remove row from pending table
function removeRow(btn) {
const row = btn.parentNode.parentNode;
row.parentNode.removeChild(row);
}
</script>

</body>
</html>
